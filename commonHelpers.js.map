{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst PIXABAY_KEY = '44174782-27b27c44e5570cc8c29375d58';\n\nconst getImages = (text, page, perPage) => {\n  return axios.get(`https://pixabay.com/api/?key=${PIXABAY_KEY}&q=${text}\n&image_type=photo&orientation=horizontal&safesearch=true\n&page=${page}&per_page=${perPage}`);\n};\n\nexport default {\n  getImages,\n};\n","const createImgCardItem = (img, key) => {\n  const imgInfoItem = document.createElement('div');\n  const itemTitle = document.createElement('span');\n  const itemValue = document.createElement('span');\n  imgInfoItem.className = 'imgInfoItem';\n  itemTitle.className = 'item';\n  itemValue.className = 'item';\n  itemTitle.className = 'itemTitle';\n  itemValue.className = 'itemValue';\n  itemTitle.innerHTML = key;\n  itemValue.innerHTML = img[key];\n  imgInfoItem.appendChild(itemTitle);\n  imgInfoItem.appendChild(itemValue);\n\n  return imgInfoItem;\n};\n\nconst createImgCard = (img) => {\n  const link = document.createElement('a');\n  const imgCard = document.createElement('div');\n  const image = document.createElement('img');\n  const imgInfo = document.createElement('div');\n  link.className = 'gallery-link';\n  link.href = img.largeImageURL;\n  link.append(image);\n  imgCard.className = 'imgCard gallery-item';\n  image.className = 'gallery-image imgBox';\n  image.alt = img.tags;\n  image.src = img.webformatURL;\n  imgInfo.className = 'imgInfo';\n  link.appendChild(image);\n  imgCard.append(link);\n  imgCard.appendChild(imgInfo);\n  imgInfo.appendChild(createImgCardItem(img, 'likes'));\n  imgInfo.appendChild(createImgCardItem(img, 'views'));\n  imgInfo.appendChild(createImgCardItem(img, 'comments'));\n  imgInfo.appendChild(createImgCardItem(img, 'downloads'));\n\n  return imgCard;\n};\n\nexport default {\n  createImgCard,\n};","import 'izitoast/dist/css/iziToast.min.css';\nimport iziToast from 'izitoast';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport pixabayApi from './js/pixabay-api.js';\nimport render from './js/render-function.js';\n\nlet page = 1;\nconst PER_PAGE = 20;\nconst TOAST_ERR = `error`;\nconst TOAST_INFO = `info`;\nconst SERVER_ERR = `Something went wrong, please try again later!`;\nconst SEARCH_TEXT_ERR = `Search text cant be empty!`;\nconst NO_IMAGES_ERR = `Sorry, there are no images matching your search\nquery. Please try again!`;\nconst LAST_PAGE_INFO = `We're sorry, but you've reached the end of\nsearch results.`;\nconst searchForm = document.querySelector('.searchForm');\nconst loaderBox = document.querySelector('.loaderBox');\nconst container = document.querySelector('.container');\nconst input = document.querySelector('.inputSearch');\nconst loadMoreBox = document.querySelector('.loadMoreBox');\nconst loadMoreBtn = document.querySelector('.loadMore');\nlet text = '';\nconst imagesArr = [];\nconst showToast = (message, type) => {\n  iziToast[type]({\n    position: 'topRight', message: message,\n  });\n};\nconst showLoading = () => loaderBox.style.display = 'flex';\nconst hideLoading = () => loaderBox.style.display = 'none';\nconst showLoadMoreBtn = () => loadMoreBox.style.display = 'flex';\nconst hideLoadMoreBtn = () => loadMoreBox.style.display = 'none';\nconst clearContainer = () => container.innerHTML = '';\nconst isNotLastPage = total => Math.round(total / PER_PAGE) !== page;\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt', captionDelay: 250, captionPosition: 'bottom',\n});\nconst autoScrollPage = () => {\n  const imgCard = document.querySelector('.imgCard');\n  if (imgCard) {\n    window.scrollBy(0, imgCard.getBoundingClientRect().height * 2);\n  }\n};\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  text = input.value;\n  page = 1;\n  imagesArr.length = 0;\n\n  if (text === '') return showToast(SEARCH_TEXT_ERR, TOAST_ERR);\n\n  clearContainer();\n  showLoading();\n  try {\n    const response = await pixabayApi.getImages(text, page, PER_PAGE);\n\n    if (response.data) {\n      const { hits, totalHits } = response.data;\n\n      if (hits.length === 0) {\n        hideLoading();\n        return showToast(NO_IMAGES_ERR, TOAST_ERR);\n      }\n\n      imagesArr.push(...hits.map(img => render.createImgCard(img)));\n      hideLoading();\n      container.append(...imagesArr);\n\n      if (isNotLastPage(totalHits)) showLoadMoreBtn();\n    }\n\n  } catch (err) {\n    console.log(err);\n    hideLoading();\n    showToast(SERVER_ERR, TOAST_ERR);\n  }\n  lightbox.refresh();\n  lightbox.next();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  try {\n    showLoading();\n    page += 1;\n    const response = await pixabayApi.getImages(text, page, PER_PAGE);\n\n    if (response.data) {\n      const { hits, totalHits } = response.data;\n\n      imagesArr.push(...hits.map(img => render.createImgCard(img)));\n      hideLoading();\n      container.append(...imagesArr);\n      autoScrollPage();\n\n      if (isNotLastPage(totalHits)) {\n        showLoadMoreBtn();\n      } else {\n        hideLoadMoreBtn();\n        showToast(LAST_PAGE_INFO, TOAST_INFO);\n      }\n    }\n\n  } catch (err) {\n    console.log(err);\n    hideLoading();\n    showToast(SERVER_ERR, TOAST_ERR);\n  }\n  lightbox.refresh();\n  lightbox.next();\n});"],"names":["PIXABAY_KEY","getImages","text","page","perPage","axios","pixabayApi","createImgCardItem","img","key","imgInfoItem","itemTitle","itemValue","createImgCard","link","imgCard","image","imgInfo","render","PER_PAGE","TOAST_ERR","TOAST_INFO","SERVER_ERR","SEARCH_TEXT_ERR","NO_IMAGES_ERR","LAST_PAGE_INFO","searchForm","loaderBox","container","input","loadMoreBox","loadMoreBtn","imagesArr","showToast","message","type","iziToast","showLoading","hideLoading","showLoadMoreBtn","hideLoadMoreBtn","clearContainer","isNotLastPage","total","lightbox","SimpleLightbox","autoScrollPage","event","response","hits","totalHits","err"],"mappings":"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"}